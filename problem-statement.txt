# Student data
students = pd.DataFrame({
    'StudentID': [1, 2, 3, 4, 5],
    'Name': ['Alice', 'Bob', 'Charlie', 'David', 'Eva'],
    'Department': ['CS', 'Math', 'CS', 'Physics', 'Math'],
    'Year': [2, 1, 3, 2, 1]
})

# Exam data
exams = pd.DataFrame({
    'ExamID': [101, 102, 103, 104, 105, 106, 107, 108],
    'StudentID': [1, 2, 1, 3, 4, 5, 3, 2],
    'Subject': ['Math', 'Math', 'CS', 'CS', 'Physics', 'Math', 'Physics', 'CS'],
    'Score': [88, 75, 92, 85, 90, 60, 70, 80]
})
-----

Average Score Per Student
Find the average score of each student across all exams.

Top Scorer in Each Subject
Identify the student with the highest score in each subject.

Exam Count Per Student
Count how many exams each student has attempted.

High Scorers
List the students who scored more than 85 in any exam.

Department-Wise Average Score
Calculate the average exam score of students for each department.

Subject Ranking
Rank students within each subject based on their scores.

Failed Students
Find students who scored less than 40 in any subject.

Overall Topper
Identify the student with the highest average score across all exams.

Department Topper
Find the top scorer (highest average) from each department.

Subject-Wise Pass Percentage
For each subject, calculate the percentage of students who scored at least 40.

Multi-Subject High Performer
Find students who scored above 80 in at least two different subjects.

Lowest Scorer in Each Subject
Find the student with the lowest score in each subject.

Year-Wise Average Score
Calculate the average exam score of students grouped by academic year.

Students Without Exams
Identify if there are any students who havenâ€™t attempted an exam.

Best Performing Department
Find the department with the highest overall average score.


 
# 1. Average Score Per Student
 
avg_scores = exams.groupby('StudentID', as_index=False)['Score'].mean().rename(columns={'Score':'AvgScore'})
sol1 = students.merge(avg_scores, on='StudentID', how='left').fillna({'AvgScore': 0})
print("\n1) Average Score Per Student")
print(sol1[['StudentID','Name','AvgScore']].to_string(index=False))

 
# 2. Top Scorer in Each Subject
 
idx = exams.groupby('Subject')['Score'].idxmax()
top_per_subject = exams.loc[idx].merge(students, on='StudentID', how='left')
print("\n2) Top Scorer in Each Subject")
print(top_per_subject[['Subject','Name','StudentID','Score']].sort_values('Subject').to_string(index=False))

 
# 3. Exam Count Per Student
 
exam_count = exams.groupby('StudentID').size().reset_index(name='ExamCount')
sol3 = students.merge(exam_count, on='StudentID', how='left').fillna({'ExamCount':0})
sol3['ExamCount'] = sol3['ExamCount'].astype(int)
print("\n3) Exam Count Per Student")
print(sol3[['Name','ExamCount']].to_string(index=False))

 
# 4. High Scorers (>85 in any exam)
 
high_scorers = exams[exams['Score'] > 85].merge(students, on='StudentID')
print("\n4) Students who scored > 85 in any exam")
print(high_scorers[['Name','Subject','Score']].to_string(index=False))

 
# 5. Department-Wise Average Score
 
dept_avg = exams.merge(students, on='StudentID').groupby('Department', as_index=False)['Score'].mean().rename(columns={'Score':'DeptAvgScore'})
print("\n5) Department-wise Average Score")
print(dept_avg.to_string(index=False))

 
# 6. Subject Ranking (rank within each subject)
 
exams_with_rank = exams.copy()
exams_with_rank['RankInSubject'] = exams_with_rank.groupby('Subject')['Score'].rank(ascending=False, method='dense')
ranked = exams_with_rank.merge(students, on='StudentID')
print("\n6) Subject Ranking (per subject)")
print(ranked[['Subject','Name','Score','RankInSubject']].sort_values(['Subject','RankInSubject']).to_string(index=False))

